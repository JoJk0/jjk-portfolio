<!doctype html>
<html>

<head>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.1.1/gsap.min.js"></script>
    <style>
        section {
            height: 90vh;
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .trigger-element {
            display: inline-block;
        }

        .trigger-element .box {
            margin: 0 20px;
            height: 70px;
            width: 70px;
            background: #888;
        }

        .big {
            transform: scale(3);
        }
    </style>
</head>

<body>
    <section>
        <h1>Scroll down.</h1>
    </section>
    <section>
        <div class="trigger-element">
            <div class="box"></div>
        </div>
    </section>
    <section>
        <h1>Keep going...</h1>
    </section>
    <section>
        <div class="trigger-element">
            <div class="box"></div>
        </div>
    </section>
    <section>
        <div class="trigger-element">
            <div class="box"></div>
        </div>
    </section>
    <section>
        <div class="trigger-element">
            <div class="box"></div>
        </div>
        <div class="trigger-element">
            <div class="box"></div>
        </div>
    </section>
    <section>
        <h1>Ok, go back up.</h1>
    </section>
</body>

</html>

<script type="text/javascript">
    const observerElements = document.querySelectorAll('.trigger-element');

    const observerOptions = {
        root: null,
        rootMargin: '0px 0px',
        threshold: 0
    };

    observerElements.forEach(el => {

        const box = el.querySelector('.box');
        el.tl = gsap.timeline({ paused: true });

        el.tl
            .to(box, { x: 90, backgroundColor: '#e6f03a', rotation: 360, ease: 'power2.inOut' })
            .to(box, { x: 0, backgroundColor: '#000', rotation: 720, ease: 'power1.inOut' })

        el.observer = new IntersectionObserver(entry => {
            if (entry[0].intersectionRatio > 0) {
                gsap.ticker.add(el.progressTween)
            } else {
                gsap.ticker.remove(el.progressTween)
            }
        }, observerOptions);

        el.progressTween = () => {
            // Get scroll distance to bottom of viewport.
            const scrollPosition = (window.scrollY + window.innerHeight);
            // Get element's position relative to bottom of viewport.
            const elPosition = (scrollPosition - el.offsetTop);
            // Set desired duration.
            const durationDistance = (window.innerHeight + el.offsetHeight);
            // Calculate tween progresss.
            const currentProgress = (elPosition / durationDistance);
            // Set progress of gsap timeline.     
            el.tl.progress(currentProgress);
        }

        el.observer.observe(el);
    });
</script>